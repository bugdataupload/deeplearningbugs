ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', Words)

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, Softmax.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot
ERROR (theano.gof.opt): node: AdvancedSubtensor(Elemwise{log,no_inplace}.0, ARange{dtype='int64'}.0, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1709, in local_advanced_indexing_crossentropy_onehot
    if _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot
ERROR (theano.gof.opt): node: AdvancedSubtensor(Elemwise{log,no_inplace}.0, ARange{dtype='int64'}.0, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1709, in local_advanced_indexing_crossentropy_onehot
    if _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, SoftmaxWithBias.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(LogSoftmax.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: LogSoftmax.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, SoftmaxWithBias.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(LogSoftmax.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: LogSoftmax.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', b)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', Words)

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, Softmax.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot
ERROR (theano.gof.opt): node: AdvancedSubtensor(Elemwise{log,no_inplace}.0, ARange{dtype='int64'}.0, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1709, in local_advanced_indexing_crossentropy_onehot
    if _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot
ERROR (theano.gof.opt): node: AdvancedSubtensor(Elemwise{log,no_inplace}.0, ARange{dtype='int64'}.0, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1709, in local_advanced_indexing_crossentropy_onehot
    if _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, SoftmaxWithBias.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(LogSoftmax.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: LogSoftmax.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, SoftmaxWithBias.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(LogSoftmax.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: LogSoftmax.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', b)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', Words)

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', <TensorType(float32, vector)>)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, Softmax.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Elemwise{log,no_inplace}.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Elemwise{log,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot
ERROR (theano.gof.opt): node: AdvancedSubtensor(Elemwise{log,no_inplace}.0, ARange{dtype='int64'}.0, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1709, in local_advanced_indexing_crossentropy_onehot
    if _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot
ERROR (theano.gof.opt): node: AdvancedSubtensor(Elemwise{log,no_inplace}.0, ARange{dtype='int64'}.0, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1709, in local_advanced_indexing_crossentropy_onehot
    if _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, SoftmaxWithBias.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(LogSoftmax.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: LogSoftmax.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(Words, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_advanced_indexing_crossentropy_onehot_grad
ERROR (theano.gof.opt): node: SoftmaxGrad(Elemwise{true_div}.0, SoftmaxWithBias.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1908, in local_advanced_indexing_crossentropy_onehot_grad
    if not _check_rows_is_arange_len_labels(rows, labels):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/nnet/nnet.py", line 1638, in _check_rows_is_arange_len_labels
    if len(shape_of[labels]) == 1 and _is_const(shape_of[labels][0], 1):
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second,no_inplace}(LogSoftmax.0, TensorConstant{(1, 1) of 0.0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: LogSoftmax.0

ERROR (theano.gof.opt): Optimization failure due to: local_fill_to_alloc
ERROR (theano.gof.opt): node: Elemwise{second}(AdvancedSubtensor.0, Elemwise{true_div}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1731, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Join.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Join.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Reshape{2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Reshape{2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor1.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor1.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(AdvancedSubtensor.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: AdvancedSubtensor.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Subtensor{int64:int64:}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Subtensor{int64:int64:}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{int32}}.0

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x1149bff50>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/fg.py", line 546, in attach_feature
    attach(self)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1322, in on_import
    self.init_r(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/compile/ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', b)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Elemwise{neq,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{neq,no_inplace}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_subtensor_merge
ERROR (theano.gof.opt): node: Subtensor{int64}(Subtensor{:int64:}.0, Constant{0})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 3072, in local_subtensor_merge
    xshape = node.fgraph.shape_feature.shape_of[x]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: Subtensor{:int64:}(Shape.0, Constant{1})
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2723, in local_useless_subtensor
    length_pos = shape_of[node.inputs[0]][pos]
KeyError: Shape.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

ERROR (theano.gof.opt): Optimization failure due to: local_useless_subtensor
ERROR (theano.gof.opt): node: AdvancedSubtensor1(Words, Elemwise{Cast{int32}}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 2769, in local_useless_subtensor
    length = get_scalar_constant_value(shape_of[node.inputs[0]][0],
KeyError: Words

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(Words)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/Volumes/Transcend/opt/anaconda3/envs/theano/lib/python2.7/site-packages/theano/tensor/opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Words

loading data... data loaded!
model architecture: CNN-non-static
using: word2vec vectors
[('image shape', 64, 300), ('filter shape', [(100, 1, 3, 300), (100, 1, 4, 300), (100, 1, 5, 300)]), ('hidden_units', [100, 2]), ('dropout', [0.5]), ('batch_size', 50), ('non_static', True), ('learn_decay', 0.95), ('conv_non_linear', 'relu'), ('non_static', True), ('sqr_norm_lim', 9), ('shuffle_batch', True)]
... training
epoch: 1, training time: 298.12 secs, train perf: 81.55 %, val perf: 78.11 %
epoch: 2, training time: 297.67 secs, train perf: 83.09 %, val perf: 75.05 %
epoch: 3, training time: 303.26 secs, train perf: 91.78 %, val perf: 81.79 %
epoch: 4, training time: 300.74 secs, train perf: 95.87 %, val perf: 80.42 %
epoch: 5, training time: 300.57 secs, train perf: 96.24 %, val perf: 82.74 %
cv: 0, perf: 0.800186741363212
0.800186741363212